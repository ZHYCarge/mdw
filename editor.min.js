(function(f){"function"===typeof require&&"object"===typeof exports&&"object"===typeof module?module.exports=f:"function"===typeof define?define.amd||define(["jquery"],f):window.editormd=f()})(function(){var f="undefined"!==typeof jQuery?jQuery:Zepto;if("undefined"!==typeof f){var e=function(a,b){return new e.fn.init(a,b)};e.title=e.$name="Editor.md";e.version="1.6.0";e.homePage="https://github.com/ZHYCarge/mdw/";e.classPrefix="editormd-";e.toolbarModes={full:"undo redo | bold del italic quote ucwords uppercase lowercase | h1 h2 h3 h4 h5 h6 | list-ul list-ol hr | link reference-link image code preformatted-text code-block table datetime emoji html-entities pagebreak | goto-line watch preview fullscreen clear search | help info".split(" "),
simple:"undo redo | bold del italic quote uppercase lowercase | h1 h2 h3 h4 h5 h6 | list-ul list-ol hr | watch preview fullscreen | help info".split(" "),mini:"undo redo | watch preview | help info".split(" ")};e.defaults={mode:"gfm",name:"",value:"",theme:"",editorTheme:"default",previewTheme:"",markdown:"",appendMarkdown:"",width:"100%",height:"100%",path:"./lib/",pluginPath:"",delay:300,autoLoadModules:!0,watch:!0,placeholder:"please input markdown content\u2026\u2026",gotoLine:!0,codeFold:!0,
autoHeight:!1,autoFocus:!0,autoCloseTags:!0,searchReplace:!0,syncScrolling:!0,readOnly:!1,tabSize:4,indentUnit:4,lineNumbers:!0,lineWrapping:!0,autoCloseBrackets:!0,showTrailingSpace:!0,matchBrackets:!0,indentWithTabs:!0,styleSelectedText:!0,matchWordHighlight:!0,styleActiveLine:!0,dialogLockScreen:!0,dialogShowMask:!0,dialogDraggable:!0,dialogMaskBgColor:"#fff",dialogMaskOpacity:.1,fontSize:"13px",saveHTMLToTextarea:!1,disabledKeyMaps:[],onload:function(){},onresize:function(){},onchange:function(){},
onwatch:null,onunwatch:null,onpreviewing:function(){},onpreviewed:function(){},onfullscreen:function(){},onfullscreenExit:function(){},onscroll:function(){},onpreviewscroll:function(){},imageUpload:!1,imageFormats:"jpg jpeg gif png bmp webp".split(" "),imageUploadURL:"",crossDomainUpload:!1,uploadCallbackURL:"",toc:!0,tocm:!1,tocTitle:"",tocDropdown:!1,tocContainer:"",tocStartLevel:1,htmlDecode:!0,pageBreak:!0,atLink:!0,emailLink:!0,taskList:!1,emoji:!0,tex:!0,flowChart:!0,sequenceDiagram:!0,previewCodeHighlight:!0,
toolbar:!0,toolbarAutoFixed:!0,toolbarIcons:"full",toolbarTitles:{},toolbarHandlers:{ucwords:function(){return e.toolbarHandlers.ucwords},lowercase:function(){return e.toolbarHandlers.lowercase}},toolbarCustomIcons:{lowercase:'<a href="javascript:;" title="Lowercase" unselectable="on"><i class="fa" name="lowercase" style="font-size:24px;margin-top: -10px;">a</i></a>',ucwords:'<a href="javascript:;" title="ucwords" unselectable="on"><i class="fa" name="ucwords" style="font-size:20px;margin-top: -3px;">Aa</i></a>'},
toolbarIconsClass:{undo:"fa-undo",redo:"fa-repeat",bold:"fa-bold",del:"fa-strikethrough",italic:"fa-italic",quote:"fa-quote-left",uppercase:"fa-font",h1:e.classPrefix+"bold",h2:e.classPrefix+"bold",h3:e.classPrefix+"bold",h4:e.classPrefix+"bold",h5:e.classPrefix+"bold",h6:e.classPrefix+"bold","list-ul":"fa-list-ul","list-ol":"fa-list-ol",hr:"fa-minus",link:"fa-link","reference-link":"fa-anchor",image:"fa-picture-o",code:"fa-code","preformatted-text":"fa-file-code-o","code-block":"fa-file-code-o",
table:"fa-table",datetime:"fa-clock-o",emoji:"fa-smile-o","html-entities":"fa-copyright",pagebreak:"fa-newspaper-o","goto-line":"fa-terminal",watch:"fa-eye-slash",unwatch:"fa-eye",preview:"fa-desktop",search:"fa-search",fullscreen:"fa-arrows-alt",clear:"fa-eraser",help:"fa-question-circle",info:"fa-info-circle"},toolbarIconTexts:{},lang:{name:"zh-cn",description:"\u5f00\u6e90\u5728\u7ebfMarkdown\u7f16\u8f91\u5668<br/>Open source online Markdown editor.",tocTitle:"\u76ee\u5f55",toolbar:{undo:"\u64a4\u9500\uff08Ctrl+Z\uff09",
redo:"\u91cd\u505a\uff08Ctrl+Y\uff09",bold:"\u7c97\u4f53",del:"\u5220\u9664\u7ebf",italic:"\u659c\u4f53",quote:"\u5f15\u7528",ucwords:"\u5c06\u6bcf\u4e2a\u5355\u8bcd\u9996\u5b57\u6bcd\u8f6c\u6210\u5927\u5199",uppercase:"\u5c06\u6240\u9009\u8f6c\u6362\u6210\u5927\u5199",lowercase:"\u5c06\u6240\u9009\u8f6c\u6362\u6210\u5c0f\u5199",h1:"\u6807\u98981",h2:"\u6807\u98982",h3:"\u6807\u98983",h4:"\u6807\u98984",h5:"\u6807\u98985",h6:"\u6807\u98986","list-ul":"\u65e0\u5e8f\u5217\u8868","list-ol":"\u6709\u5e8f\u5217\u8868",
hr:"\u6a2a\u7ebf",link:"\u94fe\u63a5","reference-link":"\u5f15\u7528\u94fe\u63a5",image:"\u6dfb\u52a0\u56fe\u7247",code:"\u884c\u5185\u4ee3\u7801","preformatted-text":"\u9884\u683c\u5f0f\u6587\u672c / \u4ee3\u7801\u5757\uff08\u7f29\u8fdb\u98ce\u683c\uff09","code-block":"\u4ee3\u7801\u5757\uff08\u591a\u8bed\u8a00\u98ce\u683c\uff09",table:"\u6dfb\u52a0\u8868\u683c",datetime:"\u65e5\u671f\u65f6\u95f4",emoji:"Emoji\u8868\u60c5","html-entities":"HTML\u5b9e\u4f53\u5b57\u7b26",pagebreak:"\u63d2\u5165\u5206\u9875\u7b26",
"goto-line":"\u8df3\u8f6c\u5230\u884c",watch:"\u5173\u95ed\u5b9e\u65f6\u9884\u89c8",unwatch:"\u5f00\u542f\u5b9e\u65f6\u9884\u89c8",preview:"\u5168\u7a97\u53e3\u9884\u89c8HTML\uff08\u6309 Shift + ESC\u8fd8\u539f\uff09",fullscreen:"\u5168\u5c4f\uff08\u6309ESC\u8fd8\u539f\uff09",clear:"\u6e05\u7a7a",search:"\u641c\u7d22",help:"\u4f7f\u7528\u5e2e\u52a9",info:"\u5173\u4e8e"+e.title},buttons:{enter:"\u786e\u5b9a",cancel:"\u53d6\u6d88",close:"\u5173\u95ed"},dialog:{link:{title:"\u6dfb\u52a0\u94fe\u63a5",
url:"\u94fe\u63a5\u5730\u5740",urlTitle:"\u94fe\u63a5\u6807\u9898",urlEmpty:"\u9519\u8bef\uff1a\u8bf7\u586b\u5199\u94fe\u63a5\u5730\u5740\u3002"},referenceLink:{title:"\u6dfb\u52a0\u5f15\u7528\u94fe\u63a5",name:"\u5f15\u7528\u540d\u79f0",url:"\u94fe\u63a5\u5730\u5740",urlId:"\u94fe\u63a5ID",urlTitle:"\u94fe\u63a5\u6807\u9898",nameEmpty:"\u9519\u8bef\uff1a\u5f15\u7528\u94fe\u63a5\u7684\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a\u3002",idEmpty:"\u9519\u8bef\uff1a\u8bf7\u586b\u5199\u5f15\u7528\u94fe\u63a5\u7684ID\u3002",
urlEmpty:"\u9519\u8bef\uff1a\u8bf7\u586b\u5199\u5f15\u7528\u94fe\u63a5\u7684URL\u5730\u5740\u3002"},image:{title:"\u6dfb\u52a0\u56fe\u7247",url:"\u56fe\u7247\u5730\u5740",link:"\u56fe\u7247\u94fe\u63a5",alt:"\u56fe\u7247\u63cf\u8ff0",uploadButton:"\u672c\u5730\u4e0a\u4f20",imageURLEmpty:"\u9519\u8bef\uff1a\u56fe\u7247\u5730\u5740\u4e0d\u80fd\u4e3a\u7a7a\u3002",uploadFileEmpty:"\u9519\u8bef\uff1a\u4e0a\u4f20\u7684\u56fe\u7247\u4e0d\u80fd\u4e3a\u7a7a\u3002",formatNotAllowed:"\u9519\u8bef\uff1a\u53ea\u5141\u8bb8\u4e0a\u4f20\u56fe\u7247\u6587\u4ef6\uff0c\u5141\u8bb8\u4e0a\u4f20\u7684\u56fe\u7247\u6587\u4ef6\u683c\u5f0f\u6709\uff1a"},
preformattedText:{title:"\u6dfb\u52a0\u9884\u683c\u5f0f\u6587\u672c\u6216\u4ee3\u7801\u5757",emptyAlert:"\u9519\u8bef\uff1a\u8bf7\u586b\u5199\u9884\u683c\u5f0f\u6587\u672c\u6216\u4ee3\u7801\u7684\u5185\u5bb9\u3002"},codeBlock:{title:"\u6dfb\u52a0\u4ee3\u7801\u5757",selectLabel:"\u4ee3\u7801\u8bed\u8a00\uff1a",selectDefaultText:"\u8bf7\u9009\u62e9\u4ee3\u7801\u8bed\u8a00",otherLanguage:"\u5176\u4ed6\u8bed\u8a00",unselectedLanguageAlert:"\u9519\u8bef\uff1a\u8bf7\u9009\u62e9\u4ee3\u7801\u6240\u5c5e\u7684\u8bed\u8a00\u7c7b\u578b\u3002",
codeEmptyAlert:"\u9519\u8bef\uff1a\u8bf7\u586b\u5199\u4ee3\u7801\u5185\u5bb9\u3002"},htmlEntities:{title:"HTML \u5b9e\u4f53\u5b57\u7b26"},help:{title:"\u4f7f\u7528\u5e2e\u52a9"}}}};e.classNames={tex:e.classPrefix+"tex"};e.dialogZindex=99999;e.$katex=null;e.$marked=null;e.$CodeMirror=null;e.$prettyPrint=null;var A,B;e.prototype=e.fn={state:{watching:!1,loaded:!1,preview:!1,fullscreen:!1},init:function(a,b){b=b||{};"object"===typeof a&&(b=a);var c=this.classPrefix=e.classPrefix;b=this.settings=f.extend(!0,
e.defaults,b);a="object"===typeof a?b.id:a;var d=this.editor=f("#"+a);this.id=a;this.lang=b.lang;var g=this.classNames={textarea:{html:c+"html-textarea",markdown:c+"markdown-textarea"}};b.pluginPath=""===b.pluginPath?b.path+"../plugins/":b.pluginPath;this.state.watching=b.watch?!0:!1;d.hasClass("editormd")||d.addClass("editormd");d.css({width:"number"===typeof b.width?b.width+"px":b.width,height:"number"===typeof b.height?b.height+"px":b.height});b.autoHeight&&d.css("height","auto");var m=this.markdownTextarea=
d.children("textarea");1>m.length&&(d.append("<textarea></textarea>"),m=this.markdownTextarea=d.children("textarea"));m.addClass(g.textarea.markdown).attr("placeholder",b.placeholder);"undefined"!==typeof m.attr("name")&&""!==m.attr("name")||m.attr("name",""!==b.name?b.name:a+"-markdown-doc");a=[b.readOnly?"":'<a href="javascript:;" class="fa fa-close '+c+'preview-close-btn"></a>',b.saveHTMLToTextarea?'<textarea class="'+g.textarea.html+'" name="'+a+'-html-code"></textarea>':"",'<div class="'+c+'preview"><div class="markdown-body '+
c+'preview-container"></div></div>','<div class="'+c+'container-mask" style="display:block;"></div>','<div class="'+c+'mask"></div>'].join("\n");d.append(a).addClass(c+"vertical");""!==b.theme&&d.addClass(c+"theme-"+b.theme);this.mask=d.children("."+c+"mask");this.containerMask=d.children("."+c+"container-mask");""!==b.markdown&&m.val(b.markdown);""!==b.appendMarkdown&&m.val(m.val()+b.appendMarkdown);this.htmlTextarea=d.children("."+g.textarea.html);this.preview=d.children("."+c+"preview");this.previewContainer=
this.preview.children("."+c+"preview-container");""!==b.previewTheme&&this.preview.addClass(c+"preview-theme-"+b.previewTheme);"function"===typeof define&&define.amd&&("undefined"!==typeof katex&&(e.$katex=katex),b.searchReplace&&!b.readOnly&&(e.loadCSS(b.path+"codemirror/addon/dialog/dialog"),e.loadCSS(b.path+"codemirror/addon/search/matchesonscrollbar")));"function"===typeof define&&define.amd||!b.autoLoadModules?("undefined"!==typeof CodeMirror&&(e.$CodeMirror=CodeMirror),"undefined"!==typeof marked&&
(e.$marked=marked),this.setCodeMirror().setToolbar().loadedDisplay()):this.loadQueues();return this},loadQueues:function(){var a=this,b=this.settings,c=b.path,d=function(){e.isIE8?a.loadedDisplay():b.flowChart||b.sequenceDiagram?e.loadScript(c+"raphael.min",function(){e.loadScript(c+"underscore.min",function(){!b.flowChart&&b.sequenceDiagram?e.loadScript(c+"sequence-diagram.min",function(){a.loadedDisplay()}):b.flowChart&&!b.sequenceDiagram?e.loadScript(c+"flowchart.min",function(){e.loadScript(c+
"jquery.flowchart.min",function(){a.loadedDisplay()})}):b.flowChart&&b.sequenceDiagram&&e.loadScript(c+"flowchart.min",function(){e.loadScript(c+"jquery.flowchart.min",function(){e.loadScript(c+"sequence-diagram.min",function(){a.loadedDisplay()})})})})}):a.loadedDisplay()};e.loadCSS(c+"codemirror/codemirror.min");b.searchReplace&&!b.readOnly&&(e.loadCSS(c+"codemirror/addon/dialog/dialog"),e.loadCSS(c+"codemirror/addon/search/matchesonscrollbar"));b.codeFold&&e.loadCSS(c+"codemirror/addon/fold/foldgutter");
e.loadScript(c+"codemirror/codemirror.min",function(){e.$CodeMirror=CodeMirror;e.loadScript(c+"codemirror/modes.min",function(){e.loadScript(c+"codemirror/addons.min",function(){a.setCodeMirror();if("gfm"!==b.mode&&"markdown"!==b.mode)return a.loadedDisplay(),!1;a.setToolbar();e.loadScript(c+"marked.min",function(){e.$marked=marked;b.previewCodeHighlight?e.loadScript(c+"prettify.min",function(){d()}):d()})})})});return this},setTheme:function(a){var b=this.classPrefix+"theme-";this.editor.removeClass(b+
this.settings.theme).addClass(b+a);this.settings.theme=a;return this},setEditorTheme:function(a){var b=this.settings;b.editorTheme=a;"default"!==a&&e.loadCSS(b.path+"codemirror/theme/"+b.editorTheme);this.cm.setOption("theme",a);return this},setCodeMirrorTheme:function(a){this.setEditorTheme(a);return this},setPreviewTheme:function(a){var b=this.classPrefix+"preview-theme-";this.preview.removeClass(b+this.settings.previewTheme).addClass(b+a);this.settings.previewTheme=a;return this},setCodeMirror:function(){var a=
this.settings,b=this.editor;"default"!==a.editorTheme&&e.loadCSS(a.path+"codemirror/theme/"+a.editorTheme);this.codeEditor=this.cm=e.$CodeMirror.fromTextArea(this.markdownTextarea[0],{mode:a.mode,theme:a.editorTheme,tabSize:a.tabSize,dragDrop:!1,autofocus:a.autoFocus,autoCloseTags:a.autoCloseTags,readOnly:a.readOnly?"nocursor":!1,indentUnit:a.indentUnit,lineNumbers:a.lineNumbers,lineWrapping:a.lineWrapping,extraKeys:{"Ctrl-Q":function(c){c.foldCode(c.getCursor())}},foldGutter:a.codeFold,gutters:["CodeMirror-linenumbers",
"CodeMirror-foldgutter"],matchBrackets:a.matchBrackets,indentWithTabs:a.indentWithTabs,styleActiveLine:a.styleActiveLine,styleSelectedText:a.styleSelectedText,autoCloseBrackets:a.autoCloseBrackets,showTrailingSpace:a.showTrailingSpace,highlightSelectionMatches:a.matchWordHighlight?{showToken:"onselected"===a.matchWordHighlight?!1:/\w/}:!1});this.codeMirror=this.cmElement=b.children(".CodeMirror");""!==a.value&&this.cm.setValue(a.value);this.codeMirror.css({fontSize:a.fontSize,width:a.watch?"50%":
"100%"});a.autoHeight&&(this.codeMirror.css("height","auto"),this.cm.setOption("viewportMargin",Infinity));a.lineNumbers||this.codeMirror.find(".CodeMirror-gutters").css("border-right","none");return this},getCodeMirrorOption:function(a){return this.cm.getOption(a)},setCodeMirrorOption:function(a,b){this.cm.setOption(a,b);return this},addKeyMap:function(a,b){this.cm.addKeyMap(a,b);return this},removeKeyMap:function(a){this.cm.removeKeyMap(a);return this},gotoLine:function(a){var b=this.settings;if(!b.gotoLine)return this;
var c=this.cm,d=c.lineCount(),g=this.preview;"string"===typeof a&&("last"===a&&(a=d),"first"===a&&(a=1));if("number"!==typeof a)return alert("Error: The line number must be an integer."),this;a=parseInt(a)-1;if(a>d)return alert("Error: The line number range 1-"+d),this;c.setCursor({line:a,ch:0});d=c.getScrollInfo().clientHeight;a=c.charCoords({line:a,ch:0},"local");c.scrollTo(null,(a.top+a.bottom-d)/2);if(b.watch){b=this.codeMirror.find(".CodeMirror-scroll")[0];a=f(b).height();d=b.scrollTop;var m=
d/b.scrollHeight;0===d?g.scrollTop(0):d+a>=b.scrollHeight-16?g.scrollTop(g[0].scrollHeight):g.scrollTop(g[0].scrollHeight*m)}c.focus();return this},extend:function(a,b){"undefined"!==typeof b&&("function"===typeof b&&(b=f.proxy(b,this)),this[a]=b);"object"===typeof a&&"undefined"===typeof a.length&&f.extend(!0,this,a);return this},set:function(a,b){"undefined"!==typeof b&&"function"===typeof b&&(b=f.proxy(b,this));this[a]=b;return this},config:function(a,b){var c=this.settings;"object"===typeof a&&
(c=f.extend(!0,c,a));"string"===typeof a&&(c[a]=b);this.settings=c;this.recreate();return this},on:function(a,b){var c=this.settings;"undefined"!==typeof c["on"+a]&&(c["on"+a]=f.proxy(b,this));return this},off:function(a){var b=this.settings;"undefined"!==typeof b["on"+a]&&(b["on"+a]=function(){});return this},showToolbar:function(a){var b=this.settings;if(b.readOnly)return this;b.toolbar&&(1>this.toolbar.length||""===this.toolbar.find("."+this.classPrefix+"menu").html())&&this.setToolbar();b.toolbar=
!0;this.toolbar.show();this.resize();f.proxy(a||function(){},this)();return this},hideToolbar:function(a){this.settings.toolbar=!1;this.toolbar.hide();this.resize();f.proxy(a||function(){},this)();return this},setToolbarAutoFixed:function(a){var b=this.state,c=this.editor,d=this.toolbar,g=this.settings;"undefined"!==typeof a&&(g.toolbarAutoFixed=a);a=function(){var m=f(window),h=m.scrollTop();if(!g.toolbarAutoFixed)return!1;10<h-c.offset().top&&h<c.height()?d.css({position:"fixed",width:c.width()+
"px",left:(m.width()-c.width())/2+"px"}):d.css({position:"absolute",width:"100%",left:0})};!b.fullscreen&&!b.preview&&g.toolbar&&g.toolbarAutoFixed&&f(window).bind("scroll",a);return this},setToolbar:function(){var a=this.settings;if(a.readOnly)return this;var b=this.editor,c=this.classPrefix,d=this.toolbar=b.children("."+c+"toolbar");a.toolbar&&1>d.length&&(b.append('<div class="'+c+'toolbar"><div class="'+c+'toolbar-container"><ul class="'+c+'menu"></ul></div></div>'),d=this.toolbar=b.children("."+
c+"toolbar"));if(!a.toolbar)return d.hide(),this;d.show();b="function"===typeof a.toolbarIcons?a.toolbarIcons():"string"===typeof a.toolbarIcons?e.toolbarModes[a.toolbarIcons]:a.toolbarIcons;d=d.find("."+this.classPrefix+"menu");c="";for(var g=!1,m=0,h=b.length;m<h;m++){var k=b[m];if("||"===k)g=!0;else if("|"===k)c+='<li class="divider" unselectable="on">|</li>';else{var v=/h(\d)/.test(k),r=k;"watch"!==k||a.watch||(r="unwatch");var u=a.lang.toolbar[r],q=a.toolbarIconTexts[r];r=a.toolbarIconsClass[r];
u="undefined"===typeof u?"":u;q="undefined"===typeof q?"":q;r="undefined"===typeof r?"":r;var y=g?'<li class="pull-right">':"<li>";"undefined"!==typeof a.toolbarCustomIcons[k]&&"function"!==typeof a.toolbarCustomIcons[k]?y+=a.toolbarCustomIcons[k]:(y+='<a href="javascript:;" title="'+u+'" unselectable="on">',y+='<i class="fa '+r+'" name="'+k+'" unselectable="on">'+(v?k.toUpperCase():""===r?q:"")+"</i>",y+="</a>");y+="</li>";c=g?y+c:c+y}}d.html(c);d.find('[title="Lowercase"]').attr("title",a.lang.toolbar.lowercase);
d.find('[title="ucwords"]').attr("title",a.lang.toolbar.ucwords);this.setToolbarHandler();this.setToolbarAutoFixed();return this},dialogLockScreen:function(){f.proxy(e.dialogLockScreen,this)();return this},dialogShowMask:function(a){f.proxy(e.dialogShowMask,this)(a);return this},getToolbarHandles:function(a){var b=this.toolbarHandlers=e.toolbarHandlers;return a&&"undefined"!==typeof toolbarIconHandlers[a]?b[a]:b},setToolbarHandler:function(){var a=this,b=this.settings;if(!b.toolbar||b.readOnly)return this;
var c=this.cm,d=this.toolbarIcons=this.toolbar.find("."+this.classPrefix+"menu > li > a"),g=this.getToolbarHandles();d.bind(e.mouseOrTouch("click","touchend"),function(m){m=f(this).children(".fa");var h=m.attr("name"),k=c.getCursor(),v=c.getSelection();if(""!==h)return a.activeIcon=m,"undefined"!==typeof g[h]?f.proxy(g[h],a)(c):"undefined"!==typeof b.toolbarHandlers[h]&&f.proxy(b.toolbarHandlers[h],a)(c,m,k,v),"link"!==h&&"reference-link"!==h&&"image"!==h&&"code-block"!==h&&"preformatted-text"!==
h&&"watch"!==h&&"preview"!==h&&"search"!==h&&"fullscreen"!==h&&"info"!==h&&c.focus(),!1});return this},createDialog:function(a){return f.proxy(e.createDialog,this)(a)},createInfoDialog:function(){var a=this,b=this.editor,c=this.classPrefix,d=['<div class="'+c+"dialog "+c+'dialog-info" style="">','<div class="'+c+'dialog-container">','<h1><i class="editormd-logo editormd-logo-lg editormd-logo-color"></i> '+e.title+"<small>v"+e.version+"</small></h1>","<p>"+this.lang.description+"</p>",'<p style="margin: 10px 0 20px 0;"><a href="'+
e.homePage+'" target="_blank">'+e.homePage+' <i class="fa fa-external-link"></i></a></p>','<p style="font-size: 0.85em;">Copyright &copy; 2015 <a href="https://github.com/ZHYCarge" target="_blank" class="hover-link">Pandao</a>, The <a href="https://github.com/ZHYCarge/mdw/blob/master/LICENSE" target="_blank" class="hover-link">MIT</a> License.</p>\n</div>','<a href="javascript:;" class="fa fa-close '+c+'dialog-close"></a>',"</div>"].join("\n");b.append(d);b=this.infoDialog=b.children("."+c+"dialog-info");
b.find("."+c+"dialog-close").bind(e.mouseOrTouch("click","touchend"),function(){a.hideInfoDialog()});b.css("border",e.isIE8?"1px solid #ddd":"").css("z-index",e.dialogZindex).show();this.infoDialogPosition();return this},infoDialogPosition:function(){var a=this.infoDialog,b=function(){a.css({top:(f(window).height()-a.height())/2+"px",left:(f(window).width()-a.width())/2+"px"})};b();f(window).resize(b);return this},showInfoDialog:function(){f("html,body").css("overflow-x","hidden");var a=this.settings,
b=this.infoDialog=this.editor.children("."+this.classPrefix+"dialog-info");1>b.length&&this.createInfoDialog();this.lockScreen(!0);this.mask.css({opacity:a.dialogMaskOpacity,backgroundColor:a.dialogMaskBgColor}).show();b.css("z-index",e.dialogZindex).show();this.infoDialogPosition();return this},hideInfoDialog:function(){f("html,body").css("overflow-x","");this.infoDialog.hide();this.mask.hide();this.lockScreen(!1);return this},lockScreen:function(a){e.lockScreen(a);this.resize();return this},recreate:function(){var a=
this.editor,b=this.settings;this.codeMirror.remove();this.setCodeMirror();b.readOnly||(0<a.find(".editormd-dialog").length&&a.find(".editormd-dialog").remove(),b.toolbar&&(this.getToolbarHandles(),this.setToolbar()));this.loadedDisplay(!0);return this},previewCodeHighlight:function(){var a=this.previewContainer;this.settings.previewCodeHighlight&&(a.find("pre").addClass("prettyprint linenums"),"undefined"!==typeof prettyPrint&&prettyPrint());return this},katexRender:function(){if(null===A)return this;
this.previewContainer.find("."+e.classNames.tex).each(function(){var a=f(this);e.$katex.render(a.text(),a[0]);a.find(".katex").css("font-size","1.6em")});return this},flowChartAndSequenceDiagramRender:function(){var a=this.settings,b=this.previewContainer;if(e.isIE8)return this;if(a.flowChart){if(null===B)return this;b.find(".flowchart").flowChart()}a.sequenceDiagram&&b.find(".sequence-diagram").sequenceDiagram({theme:"simple"});a=this.preview;b=this.codeMirror.find(".CodeMirror-scroll");var c=b.height(),
d=b.scrollTop(),g=d/b[0].scrollHeight,m=0;a.find(".markdown-toc-list").each(function(){m+=f(this).height()});var h=a.find(".editormd-toc-menu").height();h=h?h:0;0===d?a.scrollTop(0):d+c>=b[0].scrollHeight-16?a.scrollTop(a[0].scrollHeight):a.scrollTop((a[0].scrollHeight+m+h)*g);return this},registerKeyMaps:function(a){var b=this,c=this.cm,d=e.toolbarHandlers,g=this.settings.disabledKeyMaps;if(a=a||null)for(var m in a)0>f.inArray(m,g)&&c.addKeyMap(a);else{for(var h in e.keyMaps)a=e.keyMaps[h],a="string"===
typeof a?f.proxy(d[a],b):f.proxy(a,b),0>f.inArray(h,["F9","F10","F11"])&&0>f.inArray(h,g)&&(m={},m[h]=a,c.addKeyMap(m));f(window).keydown(function(k){if(0>f.inArray({120:"F9",121:"F10",122:"F11"}[k.keyCode],g))switch(k.keyCode){case 120:return f.proxy(d.watch,b)(),!1;case 121:return f.proxy(d.preview,b)(),!1;case 122:return f.proxy(d.fullscreen,b)(),!1}})}return this},bindScrollEvent:function(){var a=this,b=this.preview,c=this.settings,d=this.codeMirror,g=e.mouseOrTouch;if(!c.syncScrolling)return this;
var m=function(){d.find(".CodeMirror-scroll").bind(g("scroll","touchmove"),function(r){var u=f(this).height(),q=f(this).scrollTop(),y=q/f(this)[0].scrollHeight,l=0;b.find(".markdown-toc-list").each(function(){l+=f(this).height()});var p=b.find(".editormd-toc-menu").height();p=p?p:0;0===q?b.scrollTop(0):q+u>=f(this)[0].scrollHeight-16?b.scrollTop(b[0].scrollHeight):b.scrollTop((b[0].scrollHeight+l+p)*y);f.proxy(c.onscroll,a)(r)})},h=function(){d.find(".CodeMirror-scroll").unbind(g("scroll","touchmove"))},
k=function(){b.bind(g("scroll","touchmove"),function(r){var u=f(this).height(),q=f(this).scrollTop(),y=q/f(this)[0].scrollHeight,l=d.find(".CodeMirror-scroll");0===q?l.scrollTop(0):q+u>=f(this)[0].scrollHeight?l.scrollTop(l[0].scrollHeight):l.scrollTop(l[0].scrollHeight*y);f.proxy(c.onpreviewscroll,a)(r)})},v=function(){b.unbind(g("scroll","touchmove"))};d.bind({mouseover:m,mouseout:h,touchstart:m,touchend:h});if("single"===c.syncScrolling)return this;b.bind({mouseover:k,mouseout:v,touchstart:k,touchend:v});
return this},bindChangeEvent:function(){var a=this,b=this.settings;if(!b.syncScrolling)return this;this.cm.on("change",function(c,d){b.watch&&a.previewContainer.css("padding",b.autoHeight?"20px 20px 50px 40px":"20px");A=setTimeout(function(){clearTimeout(A);a.save();A=null},b.delay)});return this},loadedDisplay:function(a){a=a||!1;var b=this,c=this.editor,d=this.preview,g=this.settings;this.containerMask.hide();this.save();g.watch&&d.show();c.data("oldWidth",c.width()).data("oldHeight",c.height());
this.resize();this.registerKeyMaps();f(window).resize(function(){b.resize()});this.bindScrollEvent().bindChangeEvent();a||f.proxy(g.onload,this)();this.state.loaded=!0;return this},width:function(a){this.editor.css("width","number"===typeof a?a+"px":a);this.resize();return this},height:function(a){this.editor.css("height","number"===typeof a?a+"px":a);this.resize();return this},resize:function(a,b){a=a||null;b=b||null;var c=this.state,d=this.editor,g=this.preview,m=this.toolbar,h=this.settings,k=
this.codeMirror;a&&d.css("width","number"===typeof a?a+"px":a);!h.autoHeight||c.fullscreen||c.preview?(b&&d.css("height","number"===typeof b?b+"px":b),c.fullscreen&&d.height(f(window).height()),h.toolbar&&!h.readOnly?k.css("margin-top",m.height()+1).height(d.height()-m.height()):k.css("margin-top",0).height(d.height())):(d.css("height","auto"),k.css("height","auto"));h.watch?(k.width(d.width()/2),g.width(c.preview?d.width():d.width()/2),this.previewContainer.css("padding",h.autoHeight?"20px 20px 50px 40px":
"20px"),h.toolbar&&!h.readOnly?g.css("top",m.height()+1):g.css("top",0),!h.autoHeight||c.fullscreen||c.preview?(a=h.toolbar&&!h.readOnly?d.height()-m.height():d.height(),g.height(a)):g.height("")):(k.width(d.width()),g.hide());c.loaded&&f.proxy(h.onresize,this)();return this},save:function(){if(null===A)return this;var a=this,b=this.state,c=this.settings,d=this.cm,g=d.getValue(),m=this.previewContainer;if("gfm"!==c.mode&&"markdown"!==c.mode)return this.markdownTextarea.val(g),this;var h=e.$marked,
k=this.markdownToC=[],v=this.markedRendererOptions={toc:c.toc,tocm:c.tocm,tocStartLevel:c.tocStartLevel,pageBreak:c.pageBreak,taskList:c.taskList,emoji:c.emoji,tex:c.tex,atLink:c.atLink,emailLink:c.emailLink,flowChart:c.flowChart,sequenceDiagram:c.sequenceDiagram,previewCodeHighlight:c.previewCodeHighlight};v=this.markedOptions={renderer:e.markedRenderer(k,v),gfm:!0,tables:!0,breaks:!0,pedantic:!1,sanitize:c.htmlDecode?!1:!0,smartLists:!0,smartypants:!0};h.setOptions(v);h=e.$marked(g,v);h=e.filterHTMLTags(h,
c.htmlDecode);this.markdownTextarea.text(g);d.save();c.saveHTMLToTextarea&&this.htmlTextarea.text(h);if(c.watch||!c.watch&&b.preview){m.html(h);this.previewCodeHighlight();c.toc&&(d=""===c.tocContainer?m:f(c.tocContainer),g=d.find("."+this.classPrefix+"toc-menu"),d.attr("previewContainer",""===c.tocContainer?"true":"false"),""!==c.tocContainer&&0<g.length&&g.remove(),e.markdownToCRenderer(k,d,c.tocDropdown,c.tocStartLevel),(c.tocDropdown||0<d.find("."+this.classPrefix+"toc-menu").length)&&e.tocDropdownMenu(d,
""!==c.tocTitle?c.tocTitle:this.lang.tocTitle),""!==c.tocContainer&&m.find(".markdown-toc").css("border","none"));c.tex&&(!e.kaTeXLoaded&&c.autoLoadModules?e.loadKaTeX(function(){e.$katex=katex;e.kaTeXLoaded=!0;a.katexRender()}):(e.$katex=katex,this.katexRender()));if(c.flowChart||c.sequenceDiagram)B=setTimeout(function(){clearTimeout(B);a.flowChartAndSequenceDiagramRender();B=null},10);b.loaded&&f.proxy(c.onchange,this)()}return this},focus:function(){this.cm.focus();return this},setCursor:function(a){this.cm.setCursor(a);
return this},getCursor:function(){return this.cm.getCursor()},setSelection:function(a,b){this.cm.setSelection(a,b);return this},getSelection:function(){return this.cm.getSelection()},setSelections:function(a){this.cm.setSelections(a);return this},getSelections:function(){return this.cm.getSelections()},replaceSelection:function(a){this.cm.replaceSelection(a);return this},insertValue:function(a){this.replaceSelection(a);return this},appendMarkdown:function(a){var b=this.cm;b.setValue(b.getValue()+
a);return this},setMarkdown:function(a){this.cm.setValue(a||this.settings.markdown);return this},getMarkdown:function(){return this.cm.getValue()},getValue:function(){return this.cm.getValue()},setValue:function(a){this.cm.setValue(a);return this},clear:function(){this.cm.setValue("");return this},getHTML:function(){return this.settings.saveHTMLToTextarea?this.htmlTextarea.val():(alert("Error: settings.saveHTMLToTextarea == false"),!1)},getTextareaSavedHTML:function(){return this.getHTML()},getPreviewedHTML:function(){return this.settings.watch?
this.previewContainer.html():(alert("Error: settings.watch == false"),!1)},watch:function(a){var b=this.settings;if(0>f.inArray(b.mode,["gfm","markdown"]))return this;this.state.watching=b.watch=!0;this.preview.show();if(this.toolbar){var c=b.toolbarIconsClass.watch,d=b.toolbarIconsClass.unwatch,g=this.toolbar.find(".fa[name=watch]");g.parent().attr("title",b.lang.toolbar.watch);g.removeClass(d).addClass(c)}this.codeMirror.css("border-right","1px solid #ddd").width(this.editor.width()/2);A=0;this.save().resize();
b.onwatch||(b.onwatch=a||function(){});f.proxy(b.onwatch,this)();return this},unwatch:function(a){var b=this.settings;this.state.watching=b.watch=!1;this.preview.hide();if(this.toolbar){var c=b.toolbarIconsClass.watch,d=b.toolbarIconsClass.unwatch,g=this.toolbar.find(".fa[name=watch]");g.parent().attr("title",b.lang.toolbar.unwatch);g.removeClass(c).addClass(d)}this.codeMirror.css("border-right","none").width(this.editor.width());this.resize();b.onunwatch||(b.onunwatch=a||function(){});f.proxy(b.onunwatch,
this)();return this},show:function(a){a=a||function(){};var b=this;this.editor.show(0,function(){f.proxy(a,b)()});return this},hide:function(a){a=a||function(){};var b=this;this.editor.hide(0,function(){f.proxy(a,b)()});return this},previewing:function(){var a=this,b=this.editor,c=this.preview,d=this.toolbar,g=this.settings,m=this.codeMirror,h=this.previewContainer;if(0>f.inArray(g.mode,["gfm","markdown"]))return this;g.toolbar&&d&&(d.toggle(),d.find(".fa[name=preview]").toggleClass("active"));m.toggle();
d=function(k){k.shiftKey&&27===k.keyCode&&a.previewed()};"none"===m.css("display")?(this.state.preview=!0,this.state.fullscreen&&c.css("background","#fff"),b.find("."+this.classPrefix+"preview-close-btn").show().bind(e.mouseOrTouch("click","touchend"),function(){a.previewed()}),g.watch?h.css("padding",""):this.save(),h.addClass(this.classPrefix+"preview-active"),c.show().css({position:"",top:0,width:b.width(),height:g.autoHeight&&!this.state.fullscreen?"auto":b.height()}),this.state.loaded&&f.proxy(g.onpreviewing,
this)(),f(window).bind("keyup",d)):(f(window).unbind("keyup",d),this.previewed())},previewed:function(){var a=this.editor,b=this.preview,c=this.toolbar,d=this.settings,g=this.previewContainer,m=a.find("."+this.classPrefix+"preview-close-btn");this.state.preview=!1;this.codeMirror.show();d.toolbar&&c.show();b[d.watch?"show":"hide"]();m.hide().unbind(e.mouseOrTouch("click","touchend"));g.removeClass(this.classPrefix+"preview-active");d.watch&&g.css("padding","20px");b.css({background:null,position:"absolute",
width:a.width()/2,height:d.autoHeight&&!this.state.fullscreen?"auto":a.height()-c.height(),top:d.toolbar?c.height():0});this.state.loaded&&f.proxy(d.onpreviewed,this)();return this},fullscreen:function(){var a=this,b=this.state,c=this.editor,d=this.toolbar,g=this.settings,m=this.classPrefix+"fullscreen";d&&d.find(".fa[name=fullscreen]").parent().toggleClass("active");d=function(h){h.shiftKey||27!==h.keyCode||b.fullscreen&&a.fullscreenExit()};c.hasClass(m)?(f(window).unbind("keyup",d),this.fullscreenExit()):
(b.fullscreen=!0,f("html,body").css("overflow","hidden"),c.css({width:f(window).width(),height:f(window).height()}).addClass(m),this.resize(),f.proxy(g.onfullscreen,this)(),f(window).bind("keyup",d));return this},fullscreenExit:function(){var a=this.editor,b=this.settings,c=this.toolbar,d=this.classPrefix+"fullscreen";this.state.fullscreen=!1;c&&c.find(".fa[name=fullscreen]").parent().removeClass("active");f("html,body").css("overflow","");a.css({width:a.data("oldWidth"),height:a.data("oldHeight")}).removeClass(d);
this.resize();f.proxy(b.onfullscreenExit,this)();return this},executePlugin:function(a,b){var c=this,d=this.cm;b=this.settings.pluginPath+b;if("function"===typeof define){if("undefined"===typeof this[a])return alert("Error: "+a+" plugin is not found, you are not load this plugin."),this;this[a](d);return this}0>f.inArray(b,e.loadFiles.plugin)?e.loadPlugin(b,function(){e.loadPlugins[a]=c[a];c[a](d)}):f.proxy(e.loadPlugins[a],this)(d);return this},search:function(a){var b=this.settings;if(!b.searchReplace)return alert("Error: settings.searchReplace == false"),
this;b.readOnly||this.cm.execCommand(a||"find");return this},searchReplace:function(){this.search("replace");return this},searchReplaceAll:function(){this.search("replaceAll");return this}};e.fn.init.prototype=e.fn;e.dialogLockScreen=function(){(this.settings||{dialogLockScreen:!0}).dialogLockScreen&&(f("html,body").css("overflow","hidden"),this.resize())};e.dialogShowMask=function(a){var b=this.editor,c=this.settings||{dialogShowMask:!0};a.css({top:(f(window).height()-a.height())/2+"px",left:(f(window).width()-
a.width())/2+"px"});c.dialogShowMask&&b.children("."+this.classPrefix+"mask").css("z-index",parseInt(a.css("z-index"))-1).show()};e.toolbarHandlers={undo:function(){this.cm.undo()},redo:function(){this.cm.redo()},bold:function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();a.replaceSelection("**"+c+"**");""===c&&a.setCursor(b.line,b.ch+2)},del:function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();a.replaceSelection("~~"+c+"~~");""===c&&a.setCursor(b.line,b.ch+2)},italic:function(){var a=
this.cm,b=a.getCursor(),c=a.getSelection();a.replaceSelection("*"+c+"*");""===c&&a.setCursor(b.line,b.ch+1)},quote:function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();0!==b.ch?(a.setCursor(b.line,0),a.replaceSelection("> "+c),a.setCursor(b.line,b.ch+2)):a.replaceSelection("> "+c)},ucfirst:function(){var a=this.cm,b=a.getSelection(),c=a.listSelections();a.replaceSelection(e.firstUpperCase(b));a.setSelections(c)},ucwords:function(){var a=this.cm,b=a.getSelection(),c=a.listSelections();a.replaceSelection(e.wordsFirstUpperCase(b));
a.setSelections(c)},uppercase:function(){var a=this.cm,b=a.getSelection(),c=a.listSelections();a.replaceSelection(b.toUpperCase());a.setSelections(c)},lowercase:function(){var a=this.cm;a.getCursor();var b=a.getSelection(),c=a.listSelections();a.replaceSelection(b.toLowerCase());a.setSelections(c)},h1:function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();0!==b.ch?(a.setCursor(b.line,0),a.replaceSelection("# "+c),a.setCursor(b.line,b.ch+2)):a.replaceSelection("# "+c)},h2:function(){var a=this.cm,
b=a.getCursor(),c=a.getSelection();0!==b.ch?(a.setCursor(b.line,0),a.replaceSelection("## "+c),a.setCursor(b.line,b.ch+3)):a.replaceSelection("## "+c)},h3:function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();0!==b.ch?(a.setCursor(b.line,0),a.replaceSelection("### "+c),a.setCursor(b.line,b.ch+4)):a.replaceSelection("### "+c)},h4:function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();0!==b.ch?(a.setCursor(b.line,0),a.replaceSelection("#### "+c),a.setCursor(b.line,b.ch+5)):a.replaceSelection("#### "+
c)},h5:function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();0!==b.ch?(a.setCursor(b.line,0),a.replaceSelection("##### "+c),a.setCursor(b.line,b.ch+6)):a.replaceSelection("##### "+c)},h6:function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();0!==b.ch?(a.setCursor(b.line,0),a.replaceSelection("###### "+c),a.setCursor(b.line,b.ch+7)):a.replaceSelection("###### "+c)},"list-ul":function(){var a=this.cm;a.getCursor();var b=a.getSelection();if(""===b)a.replaceSelection("- "+b);else{b=b.split("\n");
for(var c=0,d=b.length;c<d;c++)b[c]=""===b[c]?"":"- "+b[c];a.replaceSelection(b.join("\n"))}},"list-ol":function(){var a=this.cm;a.getCursor();var b=a.getSelection();if(""===b)a.replaceSelection("1. "+b);else{b=b.split("\n");for(var c=0,d=b.length;c<d;c++)b[c]=""===b[c]?"":c+1+". "+b[c];a.replaceSelection(b.join("\n"))}},hr:function(){var a=this.cm,b=a.getCursor();a.getSelection();a.replaceSelection((0!==b.ch?"\n\n":"\n")+"------------\n\n")},tex:function(){if(!this.settings.tex)return alert("settings.tex === false"),
this;var a=this.cm,b=a.getCursor(),c=a.getSelection();a.replaceSelection("$$"+c+"$$");""===c&&a.setCursor(b.line,b.ch+2)},link:function(){this.executePlugin("linkDialog","link-dialog/link-dialog")},"reference-link":function(){this.executePlugin("referenceLinkDialog","reference-link-dialog/reference-link-dialog")},pagebreak:function(){if(!this.settings.pageBreak)return alert("settings.pageBreak === false"),this;var a=this.cm;a.getSelection();a.replaceSelection("\r\n[========]\r\n")},image:function(){this.executePlugin("imageDialog",
"image-dialog/image-dialog")},code:function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();a.replaceSelection("`"+c+"`");""===c&&a.setCursor(b.line,b.ch+1)},"code-block":function(){this.executePlugin("codeBlockDialog","code-block-dialog/code-block-dialog")},"preformatted-text":function(){this.executePlugin("preformattedTextDialog","preformatted-text-dialog/preformatted-text-dialog")},table:function(){this.executePlugin("tableDialog","table-dialog/table-dialog")},datetime:function(){var a=this.cm;
a.getSelection();var b=this.settings.lang.name;b=e.dateFormat()+" "+e.dateFormat("zh-cn"===b||"zh-tw"===b?"cn-week-day":"week-day");a.replaceSelection(b)},emoji:function(){this.executePlugin("emojiDialog","emoji-dialog/emoji-dialog")},"html-entities":function(){this.executePlugin("htmlEntitiesDialog","html-entities-dialog/html-entities-dialog")},"goto-line":function(){this.executePlugin("gotoLineDialog","goto-line-dialog/goto-line-dialog")},watch:function(){this[this.settings.watch?"unwatch":"watch"]()},
preview:function(){this.previewing()},fullscreen:function(){this.fullscreen()},clear:function(){this.clear()},search:function(){this.search()},help:function(){this.executePlugin("helpDialog","help-dialog/help-dialog")},info:function(){this.showInfoDialog()}};e.keyMaps={"Ctrl-1":"h1","Ctrl-2":"h2","Ctrl-3":"h3","Ctrl-4":"h4","Ctrl-5":"h5","Ctrl-6":"h6","Ctrl-B":"bold","Ctrl-D":"datetime","Ctrl-E":function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();this.settings.emoji?(a.replaceSelection(":"+
c+":"),""===c&&a.setCursor(b.line,b.ch+1)):alert("Error: settings.emoji == false")},"Ctrl-Alt-G":"goto-line","Ctrl-H":"hr","Ctrl-I":"italic","Ctrl-K":"code","Ctrl-L":function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();a.replaceSelection("["+c+"]("+(""===c?"":' "'+c+'"')+")");""===c&&a.setCursor(b.line,b.ch+1)},"Ctrl-U":"list-ul","Shift-Ctrl-A":function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();this.settings.atLink?(a.replaceSelection("@"+c),""===c&&a.setCursor(b.line,b.ch+1)):alert("Error: settings.atLink == false")},
"Shift-Ctrl-C":"code","Shift-Ctrl-Q":"quote","Shift-Ctrl-S":"del","Shift-Ctrl-K":"tex","Shift-Alt-C":function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();a.replaceSelection(["```",c,"```"].join("\n"));""===c&&a.setCursor(b.line,b.ch+3)},"Shift-Ctrl-Alt-C":"code-block","Shift-Ctrl-H":"html-entities","Shift-Alt-H":"help","Shift-Ctrl-E":"emoji","Shift-Ctrl-U":"uppercase","Shift-Alt-U":"ucwords","Shift-Ctrl-Alt-U":"ucfirst","Shift-Alt-L":"lowercase","Shift-Ctrl-I":function(){var a=this.cm,b=a.getCursor(),
c=a.getSelection();a.replaceSelection("!["+c+"]("+(""===c?"":' "'+c+'"')+")");""===c&&a.setCursor(b.line,b.ch+4)},"Shift-Ctrl-Alt-I":"image","Shift-Ctrl-L":"link","Shift-Ctrl-O":"list-ol","Shift-Ctrl-P":"preformatted-text","Shift-Ctrl-T":"table","Shift-Alt-P":"pagebreak",F9:"watch",F10:"preview",F11:"fullscreen"};var C=function(a){return String.prototype.trim?a.trim():a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")};e.trim=C;e.ucwords=e.wordsFirstUpperCase=function(a){return a.toLowerCase().replace(/\b(\w)|\s(\w)/g,
function(b){return b.toUpperCase()})};e.firstUpperCase=e.ucfirst=function(a){return a.toLowerCase().replace(/\b(\w)/,function(b){return b.toUpperCase()})};e.urls={atLinkBase:"https://github.com/"};e.regexs={atLink:/@(\w+)/g,email:/(\w+)@(\w+)\.(\w+)\.?(\w+)?/g,emailLink:/(mailto:)?([\w\._]+)@(\w+)\.(\w+)\.?(\w+)?/g,emoji:/:([\w\+-]+):/g,emojiDatetime:/(\d{2}:\d{2}:\d{2})/g,twemoji:/:(tw-([\w]+)-?(\w+)?):/g,fontAwesome:/:(fa-([\w]+)(-(\w+)){0,}):/g,editormdLogo:/:(editormd-logo-?(\w+)?):/g,pageBreak:/^\[[=]{8,}\]$/};
e.emoji={path:"http://www.emoji-cheat-sheet.com/graphics/emojis/",ext:".png"};e.twemoji={path:"http://twemoji.maxcdn.com/36x36/",ext:".png"};e.markedRenderer=function(a,b){var c=f.extend({toc:!0,tocm:!1,tocStartLevel:1,pageBreak:!0,atLink:!0,emailLink:!0,taskList:!1,emoji:!1,tex:!1,flowChart:!1,sequenceDiagram:!1},b||{}),d=e.$marked;b=new d.Renderer;a=a||[];var g=e.regexs,m=g.atLink,h=g.emoji,k=g.email,v=g.emailLink,r=g.twemoji,u=g.fontAwesome,q=g.editormdLogo,y=g.pageBreak;b.emoji=function(l){l=
l.replace(e.regexs.emojiDatetime,function(t){return t.replace(/:/g,"&#58;")});var p=l.match(h);if(!p||!c.emoji)return l;for(var n=0,x=p.length;n<x;n++)":+1:"===p[n]&&(p[n]=":\\+1:"),l=l.replace(new RegExp(p[n]),function(t,w){var z=t.match(u);w=t.replace(/:/g,"");if(z)for(w=z.length;0<w;)return w=z[0].replace(/:/g,""),'<i class="fa '+w+' fa-emoji" title="'+w.replace("fa-","")+'"></i>';else if(z=t.match(q),t=t.match(r),z)for(w=z.length;0<w;)return w=z[0].replace(/:/g,""),'<i class="'+w+'" title="Editor.md logo ('+
w+')"></i>';else if(t)for(w=t.length;0<w;)return w=t[0].replace(/:/g,"").replace("tw-",""),'<img src="'+e.twemoji.path+w+e.twemoji.ext+'" title="twemoji-'+w+'" alt="twemoji-'+w+'" class="emoji twemoji" />';else return t="+1"===w?"plus1":w,t="black_large_square"===t?"black_square":t,'<img src="'+e.emoji.path+("moon"===t?"waxing_gibbous_moon":t)+e.emoji.ext+'" class="emoji" title="&#58;'+w+'&#58;" alt="&#58;'+w+'&#58;" />'});return l};b.atLink=function(l){m.test(l)&&(c.atLink&&(l=l.replace(k,function(p,
n,x,t){return p.replace(/@/g,"_#_&#64;_#_")}),l=l.replace(m,function(p,n){return'<a href="'+e.urls.atLinkBase+n+'" title="&#64;'+n+'" class="at-link">'+p+"</a>"}).replace(/_#_&#64;_#_/g,"@")),c.emailLink&&(l=l.replace(v,function(p,n,x,t,w){return!n&&0>f.inArray(w,"jpg jpeg png gif webp ico icon pdf".split(" "))?'<a href="mailto:'+p+'">'+p+"</a>":p})));return l};b.link=function(l,p,n){if(this.options.sanitize){try{var x=decodeURIComponent(unescape(l)).replace(/[^\w:]/g,"").toLowerCase()}catch(t){return""}if(0===
x.indexOf("javascript:"))return""}l='<a href="'+l+'"';if(m.test(p)||m.test(n))return p&&(l+=' title="'+p.replace(/@/g,"&#64;")),l+'">'+n.replace(/@/g,"&#64;")+"</a>";p&&(l+=' title="'+p+'"');return l+(">"+n+"</a>")};b.heading=function(l,p,n){n=l;var x=/\s*<a\s*href="(.*)"\s*([^>]*)>(.*)<\/a>\s*/;if(x.test(l)){var t=[];l=l.split(/<a\s*([^>]+)>([^>]*)<\/a>/);for(var w=0,z=l.length;w<z;w++)t.push(l[w].replace(/\s*href="(.*)"\s*/g,""));l=t.join(" ")}l=C(l);t=l.toLowerCase().replace(/[^\w]+/g,"-");t={text:l,
level:p,slug:t};w=/^[\u4e00-\u9fa5]+$/.test(l)?escape(l).replace(/%/g,""):l.toLowerCase().replace(/[^\w]+/g,"-");a.push(t);t="<h"+p+' id="h'+p+"-"+this.options.headerPrefix+w+'">';t=t+('<a name="'+l+'" class="reference-link"></a><span class="header-link octicon octicon-link"></span>')+(x?this.atLink(this.emoji(n)):this.atLink(this.emoji(l)));return t+="</h"+p+">"};b.pageBreak=function(l){y.test(l)&&c.pageBreak&&(l='<hr style="page-break-after:always;" class="page-break editormd-page-break" />');return l};
b.paragraph=function(l){var p=/\$\$(.*)\$\$/g.test(l),n=/^\$\$(.*)\$\$$/.test(l),x=n?' class="'+e.classNames.tex+'"':"",t=c.tocm?/^(\[TOC\]|\[TOCM\])$/.test(l):/^\[TOC\]$/.test(l),w=/^\[TOCM\]$/.test(l);l=!n&&p?l.replace(/(\$\$([^\$]*)\$\$)+/g,function(z,D){return'<span class="'+e.classNames.tex+'">'+D.replace(/\$/g,"")+"</span>"}):n?l.replace(/\$/g,""):l;p='<div class="markdown-toc editormd-markdown-toc">'+l+"</div>";return t?w?'<div class="editormd-toc-menu">'+p+"</div><br/>":p:y.test(l)?this.pageBreak(l):
"<p"+x+">"+this.atLink(this.emoji(l))+"</p>\n"};b.code=function(l,p,n){return"seq"===p||"sequence"===p?'<div class="sequence-diagram">'+l+"</div>":"flow"===p?'<div class="flowchart">'+l+"</div>":"math"===p||"latex"===p||"katex"===p?'<p class="'+e.classNames.tex+'">'+l+"</p>":d.Renderer.prototype.code.apply(this,arguments)};b.tablecell=function(l,p){var n=p.header?"th":"td";return(p.align?"<"+n+' style="text-align:'+p.align+'">':"<"+n+">")+this.atLink(this.emoji(l))+"</"+n+">\n"};b.listitem=function(l){return c.taskList&&
/^\s*\[[x\s]\]\s*/.test(l)?(l=l.replace(/^\s*\[\s\]\s*/,'<input type="checkbox" class="task-list-item-checkbox" /> ').replace(/^\s*\[x\]\s*/,'<input type="checkbox" class="task-list-item-checkbox" checked disabled /> '),'<li style="list-style: none;">'+this.atLink(this.emoji(l))+"</li>"):"<li>"+this.atLink(this.emoji(l))+"</li>"};return b};e.markdownToCRenderer=function(a,b,c,d){var g="",m=0,h=this.classPrefix;d=d||1;for(var k=0,v=a.length;k<v;k++){var r=a[k].text,u=a[k].level;u<d||(g=u>m?g+"":u<
m?g+Array(m-u+2).join("</ul></li>"):g+"</ul></li>",g+='<li><a class="toc-level-'+u+'" href="#'+r+'" level="'+u+'">'+r+"</a><ul>",m=u)}a=b.find(".markdown-toc");1>a.length&&"false"===b.attr("previewContainer")&&(a='<div class="markdown-toc '+h+'markdown-toc"></div>',b.html(c?'<div class="'+h+'toc-menu">'+a+"</div>":a),a=b.find(".markdown-toc"));c&&a.wrap('<div class="'+h+'toc-menu"></div><br/>');a.html('<ul class="markdown-toc-list"></ul>').children(".markdown-toc-list").html(g.replace(/\r?\n?<ul><\/ul>/g,
""));return a};e.tocDropdownMenu=function(a,b){b=b||"Table of Contents";var c=400;a=a.find("."+this.classPrefix+"toc-menu");a.each(function(){var d=f(this),g=d.children(".markdown-toc"),m='<a href="javascript:;" class="toc-menu-btn"><i class="fa fa-angle-down"></i>'+b+"</a>",h=g.children("ul"),k=h.find("li");g.append(m);k.first().before("<li><h1>"+b+' <i class="fa fa-angle-down"></i></h1></li>');d.mouseover(function(){h.show();k.each(function(){var v=f(this),r=v.children("ul");""===r.html()&&r.remove();
if(0<r.length&&""!==r.html()){var u=v.children("a").first();1>u.children(".fa").length&&u.append(f('<i class="fa fa-angle-down"></i>').css({float:"right",paddingTop:"4px"}))}v.mouseover(function(){r.css("z-index",c).show();c+=1}).mouseleave(function(){r.hide()})})}).mouseleave(function(){h.hide()})});return a};e.filterHTMLTags=function(a,b){"string"!==typeof a&&(a=new String(a));if("string"!==typeof b)return a;var c=b.split("|");b=c[0].split(",");var d=c[1];c=0;for(var g=b.length;c<g;c++){var m=b[c];
a=a.replace(new RegExp("<s*"+m+"s*([^>]*)>([^>]*)<s*/"+m+"s*>","igm"),"")}"undefined"!==typeof d&&(b=/<(\w+)\s*([^>]*)>([^>]*)<\/(\w+)>/ig,a="*"===d?a.replace(b,function(h,k,v,r,u){return"<"+k+">"+r+"</"+u+">"}):"on*"===d?a.replace(b,function(h,k,v,r,u){k=f("<"+k+">"+r+"</"+u+">");h=f(h)[0].attributes;var q={};f.each(h,function(y,l){'"'!==l.nodeName&&(q[l.nodeName]=l.nodeValue)});f.each(q,function(y){0===y.indexOf("on")&&delete q[y]});k.attr(q);h="undefined"!==typeof k[1]?f(k[1]).text():"";return k[0].outerHTML+
h}):a.replace(b,function(h,k,v,r){var u=d.split(","),q=f(h);q.html(r);f.each(u,function(y){q.attr(u[y],null)});return q[0].outerHTML}));return a};e.markdownToHTML=function(a,b){e.$marked=marked;var c=f("#"+a);a=c.settings=f.extend(!0,{gfm:!0,toc:!0,tocm:!1,tocStartLevel:1,tocTitle:"\u76ee\u5f55",tocDropdown:!1,tocContainer:"",markdown:"",markdownSourceCode:!1,htmlDecode:!1,autoLoadKaTeX:!0,pageBreak:!0,atLink:!0,emailLink:!0,tex:!1,taskList:!1,emoji:!1,flowChart:!1,sequenceDiagram:!1,previewCodeHighlight:!0},
b||{});var d=c.find("textarea");1>d.length&&(c.append("<textarea></textarea>"),d=c.find("textarea"));var g=""===a.markdown?d.val():a.markdown;b=[];var m={renderer:e.markedRenderer(b,{toc:a.toc,tocm:a.tocm,tocStartLevel:a.tocStartLevel,taskList:a.taskList,emoji:a.emoji,tex:a.tex,pageBreak:a.pageBreak,atLink:a.atLink,emailLink:a.emailLink,flowChart:a.flowChart,sequenceDiagram:a.sequenceDiagram,previewCodeHighlight:a.previewCodeHighlight}),gfm:a.gfm,tables:!0,breaks:!0,pedantic:!1,sanitize:a.htmlDecode?
!1:!0,smartLists:!0,smartypants:!0};g=new String(g);m=marked(g,m);m=e.filterHTMLTags(m,a.htmlDecode);a.markdownSourceCode?d.text(g):d.remove();c.addClass("markdown-body "+this.classPrefix+"html-preview").append(m);g=""!==a.tocContainer?f(a.tocContainer):c;""!==a.tocContainer&&g.attr("previewContainer",!1);a.toc&&(c.tocContainer=this.markdownToCRenderer(b,g,a.tocDropdown,a.tocStartLevel),(a.tocDropdown||0<c.find("."+this.classPrefix+"toc-menu").length)&&this.tocDropdownMenu(c,a.tocTitle),""!==a.tocContainer&&
c.find(".editormd-toc-menu, .editormd-markdown-toc").remove());a.previewCodeHighlight&&(c.find("pre").addClass("prettyprint linenums"),prettyPrint());e.isIE8||(a.flowChart&&c.find(".flowchart").flowChart(),a.sequenceDiagram&&c.find(".sequence-diagram").sequenceDiagram({theme:"simple"}));if(a.tex){var h=function(){c.find("."+e.classNames.tex).each(function(){var k=f(this);katex.render(k.html().replace(/&lt;/g,"<").replace(/&gt;/g,">"),k[0]);k.find(".katex").css("font-size","1.6em")})};!a.autoLoadKaTeX||
e.$katex||e.kaTeXLoaded?h():this.loadKaTeX(function(){e.$katex=katex;e.kaTeXLoaded=!0;h()})}c.getMarkdown=function(){return d.val()};return c};e.themes=["default","dark"];e.previewThemes=["default","dark"];e.editorThemes="default 3024-day 3024-night ambiance ambiance-mobile base16-dark base16-light blackboard cobalt eclipse elegant erlang-dark lesser-dark mbo mdn-like midnight monokai neat neo night paraiso-dark paraiso-light pastel-on-dark rubyblue solarized the-matrix tomorrow-night-eighties twilight vibrant-ink xq-dark xq-light".split(" ");
e.loadPlugins={};e.loadFiles={js:[],css:[],plugin:[]};e.loadPlugin=function(a,b,c){b=b||function(){};this.loadScript(a,function(){e.loadFiles.plugin.push(a);b()},c)};e.loadCSS=function(a,b,c){c=c||"head";b=b||function(){};var d=document.createElement("link");d.type="text/css";d.rel="stylesheet";d.onload=d.onreadystatechange=function(){e.loadFiles.css.push(a);b()};d.href=a+".css";"head"===c?document.getElementsByTagName("head")[0].appendChild(d):document.body.appendChild(d)};e.isIE="Microsoft Internet Explorer"==
navigator.appName;e.isIE8=e.isIE&&"8."==navigator.appVersion.match(/8./i);e.loadScript=function(a,b,c){c=c||"head";b=b||function(){};var d=null;d=document.createElement("script");d.id=a.replace(/[\./]+/g,"-");d.type="text/javascript";d.src=a+".js";e.isIE8?d.onreadystatechange=function(){!d.readyState||"loaded"!==d.readyState&&"complete"!==d.readyState||(d.onreadystatechange=null,e.loadFiles.js.push(a),b())}:d.onload=function(){e.loadFiles.js.push(a);b()};"head"===c?document.getElementsByTagName("head")[0].appendChild(d):
document.body.appendChild(d)};e.katexURL={css:"//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.3.0/katex.min",js:"//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.3.0/katex.min"};e.kaTeXLoaded=!1;e.loadKaTeX=function(a){e.loadCSS(e.katexURL.css,function(){e.loadScript(e.katexURL.js,a||function(){})})};e.lockScreen=function(a){f("html,body").css("overflow",a?"hidden":"")};e.createDialog=function(a){a=f.extend(!0,{name:"",width:420,height:240,title:"",drag:!0,closed:!0,content:"",mask:!0,maskStyle:{backgroundColor:"#fff",
opacity:.1},lockScreen:!0,footer:!0,buttons:!1},a);var b=this,c=this.editor,d=e.classPrefix,g=(new Date).getTime(),m=""===a.name?d+"dialog-"+g:a.name;g=e.mouseOrTouch;var h='<div class="'+d+"dialog "+m+'">';""!==a.title&&(h+='<div class="'+d+'dialog-header"'+(a.drag?' style="cursor: move;"':"")+">",h+='<strong class="'+d+'dialog-title">'+a.title+"</strong>",h+="</div>");a.closed&&(h+='<a href="javascript:;" class="fa fa-close '+d+'dialog-close"></a>');h+='<div class="'+d+'dialog-container">'+a.content;
if(a.footer||"string"===typeof a.footer)h+='<div class="'+d+'dialog-footer">'+("boolean"===typeof a.footer?"":a.footer)+"</div>";c.append(h+'</div><div class="'+(d+"dialog-mask "+d+'dialog-mask-bg"></div><div class="')+(d+"dialog-mask "+d+'dialog-mask-con"></div></div>'));var k=c.find("."+m);k.lockScreen=function(n){a.lockScreen&&(f("html,body").css("overflow",n?"hidden":""),b.resize());return k};k.showMask=function(){a.mask&&c.find("."+d+"mask").css(a.maskStyle).css("z-index",e.dialogZindex-1).show();
return k};k.hideMask=function(){a.mask&&c.find("."+d+"mask").hide();return k};k.loading=function(n){k.find("."+d+"dialog-mask")[n?"show":"hide"]();return k};k.lockScreen(!0).showMask();k.show().css({zIndex:e.dialogZindex,border:e.isIE8?"1px solid #ddd":"",width:"number"===typeof a.width?a.width+"px":a.width,height:"number"===typeof a.height?a.height+"px":a.height});m=function(){k.css({top:(f(window).height()-k.height())/2+"px",left:(f(window).width()-k.width())/2+"px"})};m();f(window).resize(m);k.children("."+
d+"dialog-close").bind(g("click","touchend"),function(){k.hide().lockScreen(!1).hideMask()});if("object"===typeof a.buttons){m=k.footer=k.find("."+d+"dialog-footer");for(var v in a.buttons){h=a.buttons[v];var r=d+v+"-btn";m.append('<button class="'+d+"btn "+r+'">'+h[0]+"</button>");h[1]=f.proxy(h[1],k);m.children("."+r).bind(g("click","touchend"),h[1])}}if(""!==a.title&&a.drag){var u,q;v=k.children("."+d+"dialog-header");a.mask||v.bind(g("click","touchend"),function(){e.dialogZindex+=2;k.css("z-index",
e.dialogZindex)});v.mousedown(function(n){n=n||window.event;u=n.clientX-parseInt(k[0].style.left);q=n.clientY-parseInt(k[0].style.top);document.onmousemove=p});var y=function(n){n.removeClass(d+"user-unselect").off("selectstart")},l=function(n){n.addClass(d+"user-unselect").on("selectstart",function(x){return!1})},p=function(n){n=n||window.event;var x=parseInt(k[0].style.left);var t=parseInt(k[0].style.top);0<=x?x+k.width()<=f(window).width()?x=n.clientX-u:(x=f(window).width()-k.width(),document.onmousemove=
null):(x=0,document.onmousemove=null);0<=t?n=n.clientY-q:(n=0,document.onmousemove=null);document.onselectstart=function(){return!1};l(f("body"));l(k);k[0].style.left=x+"px";k[0].style.top=n+"px"};document.onmouseup=function(){y(f("body"));y(k);document.onselectstart=null;document.onmousemove=null};v.touchDraggable=function(){var n=null;this.bind("touchstart",function(x){x=x.originalEvent;var t=f(this).parent().position();n={x:x.changedTouches[0].pageX-t.left,y:x.changedTouches[0].pageY-t.top}}).bind("touchmove",
function(x){x.preventDefault();x=x.originalEvent;f(this).parent().css({top:x.changedTouches[0].pageY-n.y,left:x.changedTouches[0].pageX-n.x})})};v.touchDraggable()}e.dialogZindex+=2;return k};e.mouseOrTouch=function(a,b){b=b||"touchend";a=a||"click";try{document.createEvent("TouchEvent"),a=b}catch(c){}return a};e.dateFormat=function(a){a=a||"";var b=function(p){return 10>p?"0"+p:p},c=new Date,d=c.getFullYear(),g=d.toString().slice(2,4),m=b(c.getMonth()+1),h=b(c.getDate()),k=c.getDay(),v=b(c.getHours()),
r=b(c.getMinutes()),u=b(c.getSeconds());b=b(c.getMilliseconds());var q="";q=g+"-"+m+"-"+h;var y=d+"-"+m+"-"+h,l=v+":"+r+":"+u;switch(a){case "UNIX Time":q=c.getTime();break;case "UTC":q=c.toUTCString();break;case "yy":q=g;break;case "year":case "yyyy":q=d;break;case "month":case "mm":q=m;break;case "cn-week-day":case "cn-wd":q="\u661f\u671f"+"\u65e5\u4e00\u4e8c\u4e09\u56db\u4e94\u516d".split("")[k];break;case "week-day":case "wd":q="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" ")[k];
break;case "day":case "dd":q=h;break;case "hour":case "hh":q=v;break;case "min":case "ii":q=r;break;case "second":case "ss":q=u;break;case "ms":q=b;break;case "yy-mm-dd":break;case "yyyy-mm-dd":q=y;break;case "yyyy-mm-dd h:i:s ms":case "full + ms":q=y+" "+l+" "+b;break;default:q=y+" "+l}return q};return e}});